"use strict";(self["webpackChunkparkinghub_v1_0"]=self["webpackChunkparkinghub_v1_0"]||[]).push([[282],{4282:function(e,t,o){o.r(t),o.d(t,{default:function(){return D}});var n=o(3396),a=o(7139),l=o(9242);const r=e=>((0,n.dD)("data-v-550ae31a"),e=e(),(0,n.Cn)(),e),c={class:"container"},u=r((()=>(0,n._)("h1",null,"Movements",-1))),s={class:"input-section"},d=r((()=>(0,n._)("option",{disabled:"",value:""},"Select a plate",-1))),i=["value"],p={class:"movements-table"},v=r((()=>(0,n._)("thead",null,[(0,n._)("tr",null,[(0,n._)("th",null,"Vehicle"),(0,n._)("th",null,"Conductor"),(0,n._)("th",null,"Register"),(0,n._)("th",null,"Active"),(0,n._)("th",null,"Departure"),(0,n._)("th",null,"Action")])],-1))),m=["onClick","disabled"],_={key:0,class:"report-popup"},w={class:"report-content"},h=r((()=>(0,n._)("h2",null,"Report",-1)));function b(e,t,o,r,b,g){return(0,n.wg)(),(0,n.iD)("div",c,[u,(0,n._)("div",s,[(0,n.wy)((0,n._)("select",{"onUpdate:modelValue":t[0]||(t[0]=t=>e.newMovementPlate=t),class:"plate-input"},[d,((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.vehicles,(e=>((0,n.wg)(),(0,n.iD)("option",{key:e.id,value:e.plate},(0,a.zw)(e.plate),9,i)))),128))],512),[[l.bM,e.newMovementPlate]]),(0,n.wy)((0,n._)("input",{"onUpdate:modelValue":t[1]||(t[1]=t=>e.newMovementConductorCPF=t),placeholder:"Conductor CPF",class:"cpf-input"},null,512),[[l.nr,e.newMovementConductorCPF]]),(0,n._)("button",{onClick:t[2]||(t[2]=(...t)=>e.createMovement&&e.createMovement(...t)),class:"add-button"},"Add Movement")]),(0,n._)("table",p,[v,(0,n._)("tbody",null,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.movements,(t=>((0,n.wg)(),(0,n.iD)("tr",{key:t.id,class:(0,a.C_)({"gray-row":""!==t.departure})},[(0,n._)("td",null,(0,a.zw)(t.vehiclePlate),1),(0,n._)("td",null,(0,a.zw)(t.conductorCPF),1),(0,n._)("td",null,(0,a.zw)(t.register),1),(0,n._)("td",null,(0,a.zw)(t.active),1),(0,n._)("td",null,(0,a.zw)(t.departure),1),(0,n._)("td",null,[(0,n._)("button",{onClick:o=>{e.openReportPopup(),e.updateDeparture(t)},disabled:""!==t.departure,class:"departure-button"},"Departure",8,m)])],2)))),128))])]),e.showReportPopup?((0,n.wg)(),(0,n.iD)("div",_,[(0,n._)("div",w,[h,(0,n._)("p",null,(0,a.zw)(e.currentMovementReport),1),(0,n._)("button",{onClick:t[3]||(t[3]=(...t)=>e.closeReportPopup&&e.closeReportPopup(...t)),class:"close-button"},"Close")])])):(0,n.kq)("",!0)])}var g=o(4870),C=(0,n.aZ)({setup(){const e=(0,g.iH)(""),t=(0,g.iH)(""),o=(0,g.iH)([]),a=(0,g.iH)([]),l=(0,g.iH)(!1),r=(0,g.iH)("");let c;const u=window.indexedDB.open("movementDatabase",1);(0,n.bv)((()=>{u.onupgradeneeded=e=>{c=e.target.result;const t=c.createObjectStore("vehicles",{keyPath:"id",autoIncrement:!0});t.createIndex("plate","plate",{unique:!0});const o=c.createObjectStore("conductors",{keyPath:"id",autoIncrement:!0});o.createIndex("cpf","cpf",{unique:!0}),c.createObjectStore("movements",{keyPath:"id",autoIncrement:!0})},u.onsuccess=e=>{c=e.target.result,s(),d()}}));const s=()=>{const e=c.transaction("vehicles","readonly"),t=e.objectStore("vehicles"),n=t.getAll();n.onsuccess=e=>{o.value=e.target.result}},d=()=>{const e=c.transaction("movements","readonly"),t=e.objectStore("movements"),o=t.getAll();o.onsuccess=e=>{a.value=e.target.result}},i=()=>{const o=c.transaction(["movements","conductors"],"readwrite"),n=o.objectStore("movements"),a=o.objectStore("conductors"),l=t.value,r=a.index("cpf").get(l);r.onsuccess=o=>{const a=o.target.result;if(a){const o={id:Date.now(),vehiclePlate:e.value,conductorCPF:l,register:(new Date).toLocaleString(),active:!0,departure:"",report:m(e.value,l)};n.add(o),e.value="",t.value="",d()}else alert("Conductor not found in the database")}},p=e=>{if(e.active){const t=c.transaction("movements","readwrite"),o=t.objectStore("movements"),n={...e};n.departure=(new Date).toLocaleString(),n.active=!1,o.put(n),d(),v(n)}},v=e=>{console.log("teste")},m=(e,t)=>"Report for movement:\n\n",_=()=>{l.value=!0},w=()=>{l.value=!1};return{newMovementPlate:e,newMovementConductorCPF:t,vehicles:o,movements:a,showReportPopup:l,currentMovementReport:r,createMovement:i,updateDeparture:p,openReportPopup:_,closeReportPopup:w}}}),P=o(89);const k=(0,P.Z)(C,[["render",b],["__scopeId","data-v-550ae31a"]]);var D=k}}]);
//# sourceMappingURL=282.6a534b81.js.map